<!doctype html><html lang=ru class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.96.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Принципы построения асинхронного API | Леруа Мерлен Tech</title><link rel=stylesheet href=https://unpkg.com/aos@next/dist/aos.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel=stylesheet><meta property="og:title" content="Принципы построения асинхронного API"><meta property="og:description" content="Пример асинхронного API Приложение отправляет сообщение получателю и продолжает работать, не дожидаясь ответа. Подход применяют, когда результат выполнения не зависит от ответа сторонней системы.
                   Kafka RabbitMQ     Комфортная скорость 100 rps 20 rps   Acknowledgment     Многоразовое чтение     Продвинутый роутинг     Приоритет сообщений     Модель пулл пуш   Скалирование брокера горизонтальное вертикальное   Скалирование клиента скалирование количества партиций топика Скалирование количества потребителей   Кейсы использования Анализ данных: трекинг, поглощение данных, логирование, аудит безопасности."><meta property="og:type" content="article"><meta property="og:url" content="/knowledge/async/"><meta property="og:image" content="https://tech.leroymerlin.ru/images/leroy-merlin-tech.jpg"><meta property="article:section" content="knowledge"><meta property="article:modified_time" content="2022-05-25T18:42:38+03:00"><meta property="og:site_name" content="Леруа Мерлен Tech"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tech.leroymerlin.ru/images/leroy-merlin-tech.jpg"><meta name=twitter:title content="Принципы построения асинхронного API"><meta name=twitter:description content="Пример асинхронного API Приложение отправляет сообщение получателю и продолжает работать, не дожидаясь ответа. Подход применяют, когда результат выполнения не зависит от ответа сторонней системы.
                   Kafka RabbitMQ     Комфортная скорость 100 rps 20 rps   Acknowledgment     Многоразовое чтение     Продвинутый роутинг     Приоритет сообщений     Модель пулл пуш   Скалирование брокера горизонтальное вертикальное   Скалирование клиента скалирование количества партиций топика Скалирование количества потребителей   Кейсы использования Анализ данных: трекинг, поглощение данных, логирование, аудит безопасности."><script async src="https://www.googletagmanager.com/gtag/js?id=G-EJPYBKPS1Q"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EJPYBKPS1Q")</script><link rel=preload href=/scss/main.min.9acae7b4b11c93e1db544cb6853bd0af2ee142611d70da69f97cd0937af83604.css as=style><link href=/scss/main.min.9acae7b4b11c93e1db544cb6853bd0af2ee142611d70da69f97cd0937af83604.css rel=stylesheet integrity></head><body><header class="header header--inner" data-header-fixed data-aos=fade-up><div class="header__wrapper container container--1920w"><a class=logo href=/ aria-label="Перейти на Главную"><svg width="60" height="48" viewBox="0 0 60 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.37215 40.9978l3.64303-3.6062-1.22314-1.2107-2.2835 2.2609-4.149-4.1095L0 35.6819l5.37215 5.3159zm1.50033-9.9505.91956.9069 1.88751-1.8746 1.09555 1.0848-1.89191 1.8747 1.17031 1.1543 2.3363-2.3129 1.0956 1.0848-3.69586 3.6626L4.41299 31.312l3.70023-3.6669L9.20877 28.73 6.87248 31.0473zM18.8355 27.6798l-3.6562-1.0371C15.3829 26.2112 15.4437 25.7275 15.3528 25.2602 15.262 24.7928 15.0243 24.3655 14.6733 24.0389 14.4634 23.8456 14.2164 23.6957 13.9468 23.5978 13.6773 23.5 13.3907 23.4563 13.1038 23.4692 12.8169 23.4821 12.5355 23.5515 12.2761 23.6732 12.0167 23.7948 11.7847 23.9664 11.5935 24.1778L8.86999 26.8726l5.39851 5.3203 1.364-1.3496-4.347-4.3048L12.1654 25.6706C12.2548 25.5786 12.3618 25.5049 12.4802 25.4538 12.5985 25.4027 12.7259 25.3751 12.8551 25.3727 12.9843 25.3703 13.1127 25.393 13.2329 25.4397 13.3532 25.4864 13.4629 25.556 13.5558 25.6446 13.7383 25.8305 13.8385 26.0803 13.8343 26.339 13.8302 26.5978 13.7221 26.8443 13.5338 27.0245L12.733 27.8187l4.6462 1.3018 1.4563-1.4407zM16.376 19.2351c1.6808-1.6621 3.9027-1.5015 5.4734.0564C23.4201 20.8494 23.5873 23.0495 21.9066 24.7116 20.2259 26.3736 18.0084 26.213 16.4332 24.6421 14.8581 23.0712 14.6953 20.8841 16.376 19.2221V19.2351zm1.0648 1.0675C16.5872 21.1445 16.8732 22.1729 17.9116 23.2014 18.9499 24.2299 19.9839 24.5033 20.8374 23.6657 21.691 22.8282 21.405 21.7954 20.3667 20.7669 19.3283 19.7385 18.2943 19.4347 17.4408 20.3026zm6.0277-3.8622-1.0031-3.0029 1.5927-1.5753 1.3331 5.151 2.1031 2.083-1.3595 1.3496-2.0943-2.0743-4.985-1.5579 1.5003-1.4841 2.8819 1.1066L23.4685 16.4404zM48.3229 34.7706l5.3766-5.3159-1.4343-1.4191-5.3722 5.316 1.4299 1.419zM27.7671 14.4182l4.1798-1.9745-3.0886 3.0551 1.2451 1.2324 5.3677-5.3203-1.7027-1.68805L29.725 11.6756l2.0239-3.95327L29.989 5.98218 24.6169 11.2981l1.2407 1.2324 3.0887-3.05501-1.9932 4.13561.814.8071zM37.0815 15.1733 36.1619 16.0802l2.0635 2.0396-1.0955 1.0849-2.0591-2.0396-1.1704 1.1543 2.5079 2.4823L35.3128 21.8865l-3.8719-3.8318 5.3722-5.3202 3.8718 3.8318-1.0955 1.0849-2.5079-2.4779zm5.1829 13.6044 3.6431 3.6105 1.2275-1.2151-2.2835-2.2565 4.149-4.1096-1.3639-1.3452-5.3722 5.3159zM56.7398 32.462 55.015 38.099H55.0106l3.7135-3.6712L60 35.6906l-5.3721 5.3159L52.9427 39.3401l1.4696-5.8106H54.4167l-3.6695 3.6322-1.2407-1.2281 5.3677-5.3159 1.8656 1.8443zM41.2481 27.7709l1.0339-3.6191C42.7192 24.3555 43.2108 24.4165 43.6854 24.326 44.1601 24.2354 44.5932 23.9981 44.9219 23.6484 45.116 23.4405 45.2664 23.1968 45.3647 22.9313 45.4629 22.6659 45.5069 22.3839 45.4942 22.1016 45.4816 21.8193 45.4124 21.5422 45.2908 21.2863 45.1692 21.0305 44.9974 20.8009 44.7855 20.6107l-2.8907-2.8641L36.5183 23.0799 37.8822 24.4295l4.3558-4.3048 1.034 1.0458C43.3621 21.2591 43.4337 21.3644 43.4826 21.4803 43.5315 21.5962 43.5567 21.7204 43.5569 21.8459 43.5571 21.9715 43.5323 22.0958 43.4838 22.2118 43.4352 22.3279 43.364 22.4334 43.2742 22.5223 43.1843 22.6112 43.0776 22.6817 42.9601 22.73 42.8426 22.7782 42.7166 22.8031 42.5894 22.8033 42.4621 22.8035 42.336 22.779 42.2184 22.7311 42.1007 22.6833 41.9938 22.6131 41.9036 22.5244L40.9181 21.5567 39.7741 26.3302l1.474 1.4407z" fill="#251b00"/><path d="M6.39258 42.0176H53.6156L30.0019 18.6406 6.39258 42.0176z" fill="#5ab030"/></svg></a><button class=menu-toggle-btn><svg class="menu-toggle-btn__icon menu-toggle-btn__icon--open" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M4 7c-.55228.0-1 .44772-1 1s.44772 1 1 1H20C20.5523 9 21 8.55228 21 8S20.5523 7 20 7H4zm0 8C3.44772 15 3 15.4477 3 16 3 16.5523 3.44772 17 4 17H20C20.5523 17 21 16.5523 21 16 21 15.4477 20.5523 15 20 15H4z" fill="currentcolor"/></svg><svg class="menu-toggle-btn__icon menu-toggle-btn__icon--close" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M25.178 23.7637C25.5685 24.1543 25.5685 24.7874 25.178 25.178 24.7874 25.5685 24.1543 25.5685 23.7637 25.178l-7.7532-7.7533L8.25726 25.178C7.86673 25.5685 7.23357 25.5685 6.84305 25.178 6.45252 24.7874 6.45252 24.1543 6.84305 23.7637l7.75325-7.7532L6.8427 8.25691c-.39053-.39052-.39053-1.02369.0-1.41421.39052-.39053 1.02369-.39053 1.41421.0l7.75359 7.7536 7.7536-7.7536C24.1546 6.45217 24.7878 6.45217 25.1783 6.8427 25.5688 7.23322 25.5688 7.86639 25.1783 8.25691L17.4247 16.0105l7.7533 7.7532z" fill="currentcolor"/></svg></button><div class=header__inner-wrapper data-fix-block><nav class="nav header__nav"><ul class=nav__list data-single data-accordion-max-width=1023><li class="nav__item is-active"><a>Инженерная культура<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.29289 16.2071C4.68342 16.5976 5.31658 16.5976 5.70711 16.2071L10.5 11.4142l4.7929 4.7929C15.6834 16.5976 16.3166 16.5976 16.7071 16.2071 17.0976 15.8166 17.0976 15.1834 16.7071 14.7929L10.5 8.58579 4.29289 14.7929c-.39052.390500000000001-.39052 1.0237.0 1.4142z" fill="#333"/></svg></a><ul class=nav__inner-list><li class=nav__inner-item><a href=/values/people/>Люди</a></li><li class=nav__inner-item><a href=/values/architecture/>Архитектура</a></li><li class=nav__inner-item><a href=/values/technology/>Технологии</a></li></ul></li><li class="nav__item is-active"><a>Стек технологий<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.29289 16.2071C4.68342 16.5976 5.31658 16.5976 5.70711 16.2071L10.5 11.4142l4.7929 4.7929C15.6834 16.5976 16.3166 16.5976 16.7071 16.2071 17.0976 15.8166 17.0976 15.1834 16.7071 14.7929L10.5 8.58579 4.29289 14.7929c-.39052.390500000000001-.39052 1.0237.0 1.4142z" fill="#333"/></svg></a><ul class=nav__inner-list><li class=nav__inner-item><a href=/stack/how-to-start/>Как начать использовать новую технологию?</a></li><li class=nav__inner-item><a href=/stack/table/>Таблица технологий</a></li></ul></li><li class="nav__item is-active"><a class=active>Знания<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.29289 16.2071C4.68342 16.5976 5.31658 16.5976 5.70711 16.2071L10.5 11.4142l4.7929 4.7929C15.6834 16.5976 16.3166 16.5976 16.7071 16.2071 17.0976 15.8166 17.0976 15.1834 16.7071 14.7929L10.5 8.58579 4.29289 14.7929c-.39052.390500000000001-.39052 1.0237.0 1.4142z" fill="#333"/></svg></a><ul class=nav__inner-list><li class=nav__inner-item><a href=/knowledge/sync/>Принципы построения синхронного API</a></li><li class=nav__inner-item><a href=/knowledge/async/>Принципы построения асинхронного API</a></li><li class=nav__inner-item><a href=/knowledge/opensource/>Как подготовить код к open source?</a></li><li class=nav__inner-item><a href=/knowledge/innersourse/>Что такое InnerSource и как его использовать?</a></li></ul></li></ul></nav><div class="socials header__socials"><ul class=socials__list><li class=socials__item><a class=socials__link href=https://github.com/adeo target=_blank><svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" aria-hidden="true"><path d="M10 0A10 10 0 006.84 19.49c.5.09.69-.21.69-.48l-.02-1.86c-2.51.46-3.16-.61-3.36-1.17-.11-.3-.6-1.18-1.03-1.42-.35-.19-.85-.65.0-.66.78-.01 1.34.72 1.53 1.03.9 1.5 2.34 1.08 2.91.82a2.1 2.1.0 01.64-1.34c-2.22-.25-4.55-1.11-4.55-4.94A3.9 3.9.0 014.67 6.8a3.6 3.6.0 01.1-2.65s.84-.26 2.76 1.02a9.28 9.28.0 015 0c1.9-1.3 2.75-1.02 2.75-1.02.54 1.37.2 2.4.1 2.65.63.7 1.02 1.58 1.02 2.68.0 3.84-2.34 4.7-4.56 4.94.36.31.67.91.67 1.85l-.01 2.75c0 .26.19.58.69.48A10.02 10.02.0 0010 0z" fill="currentcolor"/></svg></a></li><li class=socials__item><a class=socials__link href=https://t.me/leroymerlintech target=_blank><svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M15.9951 1.01983C16.0596.26112 15.4791-.181461 14.7052.0714424 11.8673 1.08306 9.09399 2.15789 6.25615 3.16951 4.32126 3.86499 2.45086 4.56048.515971 5.31919.193489 5.44564.0 5.63532.0 5.95144.0 6.26757.193489 6.45725.515971 6.5837 1.41892 6.89983 2.38637 7.21596 3.28932 7.53209c.58046.18968 1.09644.12645 1.61241-.18968 1.93489-1.20129 3.86978-2.40258 5.86917-3.6671C11.0289 3.48564 11.3514 3.35919 11.6094 3.16951 11.7383 3.10628 11.8673 3.04306 11.9963 3.16951 12.1253 3.29596 12.0608 3.42241 11.9318 3.54886l-.1935.18968L7.03011 8.16435C6.57863 8.60693 6.57863 8.98628 7.0946 9.36564c1.54792 1.13806 3.1603 2.21286 4.7082 3.35096C12.5768 13.2856 13.4152 12.9695 13.6087 12.0211c.516-2.14965 2.3219-10.11611 2.3864-11.00127z" fill="#888"/></svg></a></li><li class=socials__item><a class=socials__link href=https://habr.com/ru/company/leroy_merlin/blog/ target=_blank><svg width="10" height="15" viewBox="0 0 10 15" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M3.32857 5.86364C4 4.93636 5 4.5 6.3 4.5 8.38571 4.5 10 5.93182 10 8.29091V15H6.67143V9.45c0-1.20682-.62143-1.88182-1.65-1.88182-.92857.0-1.69286.61364-1.69286 1.93637V15H0V0H3.32857V5.86364z" fill="#888"/></svg></a></li><li class=socials__item><a class=socials__link href=https://vc.ru/leroymerlintech target=_blank><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M12.8058 7.42086C13.9835 7.42086 14.8702 6.93019 15.524 6.07597L14.6502 5.4093c-.2158.28445-.4948.51489-.8149.67315-.32.15827-.672499999999999.24003-1.0295.23885-1.2783.0-2.2045-1.04134-2.2045-2.31912C10.6013 2.72441 11.5124 1.62442 12.8422 1.62442c.591099999999999.0 1.0089.13955 1.3733.36533V3.11329h1.0996V1.47508L15.1044 1.3093C14.5.833743 13.5769.581299 12.8053.581299c-1.8862.0-3.42043 1.534231-3.42043 3.420451.0 1.88444 1.53333 3.41911 3.42043 3.41911H12.8058zm2.2813 6.74664L15.048 12.5929V8.75019H12.7546v1.1h1.1352V12.4573C13.8898 13.5804 13.032 14.3755 12.1666 14.3755 11.3013 14.3755 10.8498 13.7755 10.8498 12.6529V8.74974H8.70753v1.1h.984V12.8435c0 1.5236.85427 2.5734 2.37777 2.5734.8756.0 1.5422-.485799999999999 1.94-1.2347H14.0271L14.184 15.2293h1.7622V14.1689H15.0884V14.1666L15.0871 14.1675zM9.13153.742635H7.22042L5.5582 5.5693H5.53242L3.87909.742635H1.84264V1.84307H2.98798L4.95909 7.34441H6.0062V7.34307L8.06176 1.84352H9.13064V.743083L9.13153.742635zM.0541992 15.2435H1.18664v-1.132H.0546437v1.132H.0541992zM4.42753 10.0257H4.41509L4.34398 8.75019H2.32264V9.75286H3.3982V14.168H2.32264v1.0609H7.3182v-1.04H4.53687V11.5244C4.66264 10.56 5.38576 9.73641 6.37242 9.73641H6.3902L6.3702 10.7222H7.46975V8.73196H6.60042C5.60487 8.72929 4.8662 9.26797 4.42709 10.0262L4.42753 10.0257z" fill="#888"/></svg></a></li></ul></div><a href=/en/knowledge/async/ class="lang-toggle header__lang-toggle en" role=button style=display:none><svg class="icon-en" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="mask0_1601_5567" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="4" y="6" width="16" height="12"><path d="M18.4762 6H5.52381C4.68223 6 4 6.71634 4 7.6v8.8C4 17.2837 4.68223 18 5.52381 18H18.4762C19.3178 18 20 17.2837 20 16.4V7.6C20 6.71634 19.3178 6 18.4762 6z" fill="#fff"/></mask><g mask="url(#mask0_1601_5567)"/><g clip-path="url(#clip0_1601_5567)"><path d="M0 6V18H24V6H0z" fill="#012169"/><path d="M0 6 24 18 0 6zM24 6 0 18z" fill="#000"/><path d="M24 6 0 18M0 6 24 18 0 6z" stroke="#fff" stroke-width="2.4"/><path d="M0 6 24 18 0 6zM24 6 0 18z" fill="#000"/><path d="M24 6 0 18M0 6 24 18 0 6z" stroke="#c8102e" stroke-width="1.6"/><path d="M12 6V18 6zM0 12H24z" fill="#000"/><path d="M0 12H24M12 6V18 6z" stroke="#fff" stroke-width="4"/><path d="M12 6V18 6zM0 12H24z" fill="#000"/><path d="M0 12H24M12 6V18 6z" stroke="#c8102e" stroke-width="2.4"/></g><defs><clipPath id="clip0_1601_5567"><rect x="4" y="6" width="16" height="12" rx="1" fill="#fff"/></clipPath></defs></svg><svg class="icon-ru" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><mask id="mask0_554_3781" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="4" y="6" width="16" height="12"><path d="M18.4762 6H5.52381C4.68223 6 4 6.71634 4 7.6v8.8C4 17.2837 4.68223 18 5.52381 18H18.4762C19.3178 18 20 17.2837 20 16.4V7.6C20 6.71634 19.3178 6 18.4762 6z" fill="#fff"/></mask><g mask="url(#mask0_554_3781)"><path d="M4 6H20v6H4V6z" fill="#f7f7f7"/><path d="M4 12H20v6H4V12z" fill="#d52b1e"/><path d="M4 10H20v4H4V10z" fill="#0039a6"/></g></svg></a></div></div><script>const menuToggle=document.querySelector(".menu-toggle-btn"),header=document.querySelector(".header"),body=document.body,scrollUp="scroll-up",scrollDown="scroll-down";let lastScroll=0;header.classList.add("header--transparent");const onScrollHeaderBehaviour=()=>{const e=window.pageYOffset,t=header.offsetHeight;e<=0&&header.classList.remove("header--fixed"),e<=t/2&body.classList.contains(scrollUp)&&header.classList.add("header--transparent"),e>10&&header.classList.remove("header--transparent"),e>20&&!header.classList.contains("header--fixed")&&(header.classList.add("header--fixed"),setTimeout(()=>{header.classList.add("animate")},1)),e>lastScroll&&!body.classList.contains(scrollDown)?(body.classList.remove(scrollUp),body.classList.add(scrollDown)):e<lastScroll&&body.classList.contains(scrollDown)&&(body.classList.remove(scrollDown),body.classList.add(scrollUp)),lastScroll=e};let timer=null;const onScrollStop=()=>{clearTimeout(timer),document.body.classList.remove("scroll-stop"),timer=setTimeout(function(){document.body.classList.add("scroll-stop")},300)};window.addEventListener("scroll",onScrollStop),window.addEventListener("scroll",onScrollHeaderBehaviour);const onNenuToggleClick=e=>{e.currentTarget.blur(),header.classList.toggle("active"),header.classList.contains("active")?(window.scrollLock.disableScrolling(),header.removeAttribute("data-aos")):(window.scrollLock.enableScrolling(),header.setAttribute("data-aos","fade-up"))};menuToggle&&menuToggle.addEventListener("click",onNenuToggleClick),window.addEventListener("resize",()=>{mediaQuery.matches||window.scrollLock.enableScrolling()}),document.addEventListener("DOMContentLoaded",()=>{window.scrollTo(0,0)})</script></header><aside class=sidebar data-accordion=parent><div class=sidebar__wrapper data-accordion=element><button class=sidebar__toggle type=button data-accordion=button>
Принципы построения асинхронного API<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.29289 16.2071C4.68342 16.5976 5.31658 16.5976 5.70711 16.2071L10.5 11.4142l4.7929 4.7929C15.6834 16.5976 16.3166 16.5976 16.7071 16.2071 17.0976 15.8166 17.0976 15.1834 16.7071 14.7929L10.5 8.58579 4.29289 14.7929c-.39052.390500000000001-.39052 1.0237.0 1.4142z" fill="#333"/></svg></button><nav class=sidebar__nav aria-label="Дополнительная навигация" data-accordion=content><ul class=sidebar__list><li class=sidebar__item><a class=active>Знания</a><div class=sidebar__item-list></div><ul class=sidebar__inner-list><li class=sidebar__inner-item><a id=m-/knowledge/sync/ href=/knowledge/sync/>Принципы построения синхронного API</a><li class=sidebar__inner-item><a class=active id=m-/knowledge/async/ href=/knowledge/async/>Принципы построения асинхронного API</a><nav id=TableOfContents><ul><li><a href=#пример-асинхронного-api>Пример асинхронного API</a></li><li><a href=#общие-правила>Общие правила</a></li><li><a href=#соглашение-о-названиях>Соглашение о названиях</a></li></ul></nav><li class=sidebar__inner-item><a id=m-/knowledge/opensource/ href=/knowledge/opensource/>Как подготовить код к open source?</a><li class=sidebar__inner-item><a id=m-/knowledge/innersourse/ href=/knowledge/innersourse/>Что такое InnerSource и как его использовать?</a></li></ul></li></ul></nav></div></aside><main><div class=inner-page><div class="container container--wide"><div class=inner-page__grid><div class=inner-page__wrapper><div class=inner-page__inner-wrapper><div class=breadcrumb><ul class=breadcrumb__list><li class=breadcrumb__item><a>Знания</a></li><li class="breadcrumb__item active" aria-current=page><a>Принципы построения асинхронного API</a></li></ul></div><div class=inner-page__content><div class=inner-page__heading><h1>Принципы построения асинхронного API</h1></div><h2 id=пример-асинхронного-api>Пример асинхронного API</h2><p>Приложение отправляет сообщение получателю и продолжает работать, не дожидаясь ответа. Подход применяют, когда результат выполнения не зависит от ответа сторонней системы.</p><div class=compare-table><svg style="display:none"><symbol id="check" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><g><path fill="#b1cc33" d="m61.5 23.3-8.013-8.013-25.71 25.71-9.26-9.26-8.013 8.013 17.42 17.44z"/></g><g><path fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="m10.5 39.76L27.92 57.2 61.5 23.31l-8.013-8.013-25.71 25.71-9.26-9.26z"/></g></symbol><symbol id="cross" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><g><path fill="#ea5a47" d="m58.14 21.78-7.76-8.013-14.29 14.22-14.22-14.22-8.013 8.013L28.217 36l-14.36 14.22 8.014 8.013 14.22-14.22 14.29 14.22 7.76-8.013L43.921 36z"/></g><g><path fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="m58.14 21.78-7.76-8.013-14.29 14.22-14.22-14.22-8.013 8.013L28.207 36l-14.35 14.22 8.014 8.013 14.22-14.22 14.29 14.22 7.76-8.013L43.921 36z"/></g></symbol></svg><div class=compare-table__wrapper><table><thead><tr><th></th><th><img src=/images/kafka.png alt="Kafka logo" width=15 height=24> Kafka</th><th><img src=/images/rabbitmq.png alt="RabbitMQ logo" width=22 height=24> RabbitMQ</th></tr></thead><tbody><tr><td>Комфортная скорость</td><td>100 rps</td><td>20 rps</td></tr><tr><td>Acknowledgment</td><td><svg width="22" height="22" aria-label="Есть"><use xlink:href="#check"/></svg></td><td><svg width="22" height="22" aria-label="Есть"><use xlink:href="#check"/></svg></td></tr><tr><td>Многоразовое чтение</td><td><svg width="22" height="22" aria-label="Есть"><use xlink:href="#check"/></svg></td><td><svg width="22" height="22" aria-label="Нет"><use xlink:href="#cross"/></svg></td></tr><tr><td>Продвинутый роутинг</td><td><svg width="22" height="22" aria-label="Нет"><use xlink:href="#cross"/></svg></td><td><svg width="22" height="22" aria-label="Есть"><use xlink:href="#check"/></svg></td></tr><tr><td>Приоритет сообщений</td><td><svg width="22" height="22" aria-label="Нет"><use xlink:href="#cross"/></svg></td><td><svg width="22" height="22" aria-label="Есть"><use xlink:href="#check"/></svg></td></tr><tr><td>Модель</td><td>пулл</td><td>пуш</td></tr><tr><td>Скалирование брокера</td><td>горизонтальное</td><td>вертикальное</td></tr><tr><td>Скалирование клиента</td><td>скалирование количества партиций топика</td><td>Скалирование количества потребителей</td></tr><tr><td>Кейсы использования</td><td><p>Анализ данных: трекинг, поглощение данных, логирование, аудит безопасности.</p><p>Процессинг реального времени: множество продюссеров с небольшим количеством консьюмеров.</p><p>Event Sourcing: моделирование изменения состояния системы через последователь­ность событий.</p></td><td><p>Сложный роутинг до потребителей.</p><p>Межмикросер­висная коммуникация.</p><p>Приложение поддерживает только легаси-протоколы, например STOMP, MQTT и другие.</p></td></tr></tbody></table></div></div><h2 id=общие-правила>Общие правила</h2><ul><li>У каждого продукта есть свой экземпляр брокера сообщений — за него ответственна система, которая публикует данные.</li><li>Всякая информация, которая ценна для нескольких систем, передаётся через канонические топики или эксчейнджи. Все каноничные топики, эксчейнджи и очереди привязаны к домену через указание канонического домена в названии.</li><li>Запрещается отправлять напрямую в RabbitMQ-очередь: вместо этого используем эксчейндж.</li></ul><hr><div class=inner-page__section><h2 id=соглашение-о-названиях>Соглашение о названиях</h2><div class="inner-page__block inner-page__block--sm"><p>Используем <code>camelCase</code> для всех полей.</p></div><h3 id=kafka-топик>Kafka Топик</h3><p><code>[app]-[type]-[int/ext]-[domain]-[object]-[version]</code></p><div class="inner-page__block inner-page__block--sm"><ul><li><span class="code code--default">app</span> название публикующего приложения</li><li><span class="code code--default">type</span><ul><li><span class="code code--default">system</span> топик используется только внутри продуктовой команды или приложения</li><li><span class="code code--default">init</span> топик для полного извлечения данных, не используется для постоянной интеграции</li><li><span class="code code--default">canonical</span> топик для публикации канонической информации</li></ul></li><li><span class="code code--default">int/ext int</span> топик используется внутри, ext топик опубликован в интернете</li><li><span class="code code--default">domain</span> канонический домен</li><li><span class="code code--default">object</span> данные, которые отправляются через это топик</li><li><span class="code code--default">version</span> версия топика</li></ul></div><div class="inner-page__block inner-page__block--sm"><div class="block-bordered block-bordered--success"><h4>Пример</h4><p><code>crm-canonical-int-customers-organization-v9</code></p></div></div><h3 id=rabbitmq-эксчейндж>RabbitMQ Эксчейндж</h3><p><code>[app]-[type]-x-[domain]-[object]-[version]</code></p><div class="inner-page__block inner-page__block--sm"><ul><li><span class="code code--default">app</span> название публикующего приложения</li><li><span class="code code--default">type</span><ul><li><span class="code code--default">tx</span> topic exchange</li><li><span class="code code--default">fx</span> fanout exchange</li><li><span class="code code--default">dx</span> direct exchange</li><li><span class="code code--default">hx</span> headers exchange</li></ul></li><li><span class="code code--default">x</span> exchange</li><li><span class="code code--default">domain</span> канонический домен</li><li><span class="code code--default">object</span> данные, передаваемые через эксчейндж</li><li><span class="code code--default">version</span> версия эксчейнджа</li></ul></div><div class="inner-page__block inner-page__block--sm"><div class="block-bordered block-bordered--success"><h4>Пример</h4><p><code>paymentGateway-tx-x-orders-paymentTask-v1</code></p></div></div><h3 id=rabbitmq-очередь>RabbitMQ Очередь</h3><p><code>[app]-[type]-q-[domain]-[object]-[filter]-[version]</code></p><div class="inner-page__block inner-page__block--sm"><ul><li><span class="code code--default">app</span> название подписавшегося приложения</li><li><span class="code code--default">type</span><ul><li><span class="code code--default">tx</span> topic exchange</li><li><span class="code code--default">fx</span> fanout exchange</li><li><span class="code code--default">dx</span> direct exchange</li><li><span class="code code--default">hx</span> headers exchange</li><li><span class="code code--default">q</span> очередь</li></ul></li><li><span class="code code--default">domain</span> канонический домен</li><li><span class="code code--default">object</span> данные, передаваемые через очередь</li><li><span class="code code--default">filter</span> описания фильтров для типов tx, dx и hx</li><li><span class="code code--default">version</span> версия очереди</li></ul></div><div class="block-bordered block-bordered--success"><h4>Пример</h4><p><code>solution-tx-q-orders-paymentTask-created-v2</code></p></div><hr><a class=button-improvement href=https://github.com/adeo/lmru--tech/issues/new? target=_blank><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.9991 5h2c.5304.0 1.0391.21071 1.4142.58579C18.7883 5.96086 18.9991 6.46957 18.9991 7v8.17C19.6665 15.4059 20.2291 15.8702 20.5874 16.4808 20.9457 17.0914 21.0765 17.809 20.9569 18.5068 20.8372 19.2046 20.4747 19.8375 19.9334 20.2939 19.3922 20.7502 18.707 21.0005 17.9991 21.0005 17.2911 21.0005 16.6059 20.7502 16.0647 20.2939 15.5234 19.8375 15.1609 19.2046 15.0412 18.5068 14.9216 17.809 15.0524 17.0914 15.4107 16.4808 15.769 15.8702 16.3316 15.4059 16.9991 15.17V7h-2v3l-4.5-4 4.5-4V5zM4.99905 8.83C4.33156 8.59409 3.76896 8.1298 3.41069 7.51919c-.35826-.6106-.48912-1.32821-.36945-2.02598C3.16092 4.79545 3.52342 4.16246 4.06468 3.70613c.54126-.45633 1.22642-.70662 1.93437-.70662.70796.0 1.39312.25029 1.93437.70662C8.47468 4.16246 8.83719 4.79545 8.95686 5.49321 9.07654 6.19098 8.94568 6.90859 8.58741 7.51919 8.22915 8.1298 7.66655 8.59409 6.99905 8.83v6.34C7.66655 15.4059 8.22915 15.8702 8.58741 16.4808 8.94568 17.0914 9.07654 17.809 8.95686 18.5068 8.83719 19.2046 8.47468 19.8375 7.93342 20.2939 7.39217 20.7502 6.70701 21.0005 5.99905 21.0005 5.2911 21.0005 4.60594 20.7502 4.06468 20.2939 3.52342 19.8375 3.16092 19.2046 3.04124 18.5068 2.92157 17.809 3.05243 17.0914 3.41069 16.4808 3.76896 15.8702 4.33156 15.4059 4.99905 15.17V8.83z" fill="#5ab030"/></svg>Предложить улучшения</a></div></div></div><div class=inner-page__last-change>Последнее изменение 25.05.2022: <a href=https://github.com/adeo/lmru--tech/commit/158d6223fdedef27aca46ddc0cfda224b67c85d9>Merge remote-tracking branch 'liga/master' (#51) (158d622)</a></div></div></div></div></div></main><footer class=footer><div class=footer__bottom><p class=footer__copy>&copy; 2022 ООО «ЛЕРУА МЕРЛЕН ВОСТОК»</p><ul class=footer__social><li class=footer__social-item><a class=footer__social-link target=_blank rel="noopener noreferrer nofollow" href=https://github.com/adeo aria-label=" "><svg class="inline-svg" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" aria-hidden="true"><path d="M10 0A10 10 0 006.84 19.49c.5.09.69-.21.69-.48l-.02-1.86c-2.51.46-3.16-.61-3.36-1.17-.11-.3-.6-1.18-1.03-1.42-.35-.19-.85-.65.0-.66.78-.01 1.34.72 1.53 1.03.9 1.5 2.34 1.08 2.91.82a2.1 2.1.0 01.64-1.34c-2.22-.25-4.55-1.11-4.55-4.94A3.9 3.9.0 014.67 6.8a3.6 3.6.0 01.1-2.65s.84-.26 2.76 1.02a9.28 9.28.0 015 0c1.9-1.3 2.75-1.02 2.75-1.02.54 1.37.2 2.4.1 2.65.63.7 1.02 1.58 1.02 2.68.0 3.84-2.34 4.7-4.56 4.94.36.31.67.91.67 1.85l-.01 2.75c0 .26.19.58.69.48A10.02 10.02.0 0010 0z" fill="currentcolor"/></svg></a></li><li class=footer__social-item><a class=footer__social-link target=_blank rel="noopener noreferrer nofollow" href=https://t.me/leroymerlintech aria-label=" "><svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.9951 1.01983C16.0596.26112 15.4791-.181461 14.7052.0714424 11.8673 1.08306 9.09399 2.15789 6.25615 3.16951 4.32126 3.86499 2.45086 4.56048.515971 5.31919.193489 5.44564.0 5.63532.0 5.95144.0 6.26757.193489 6.45725.515971 6.5837 1.41892 6.89983 2.38637 7.21596 3.28932 7.53209c.58046.18968 1.09644.12645 1.61241-.18968 1.93489-1.20129 3.86978-2.40258 5.86917-3.6671C11.0289 3.48564 11.3514 3.35919 11.6094 3.16951 11.7383 3.10628 11.8673 3.04306 11.9963 3.16951 12.1253 3.29596 12.0608 3.42241 11.9318 3.54886l-.1935.18968L7.03011 8.16435C6.57863 8.60693 6.57863 8.98628 7.0946 9.36564c1.54792 1.13806 3.1603 2.21286 4.7082 3.35096C12.5768 13.2856 13.4152 12.9695 13.6087 12.0211c.516-2.14965 2.3219-10.11611 2.3864-11.00127z" fill="currentcolor"/></svg></a></li><li class=footer__social-item><a class=footer__social-link target=_blank rel="noopener noreferrer nofollow" href=https://habr.com/ru/company/leroy_merlin/blog/ aria-label=" "><svg width="10" height="15" viewBox="0 0 10 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.32857 5.86364C4 4.93636 5 4.5 6.3 4.5 8.38571 4.5 10 5.93182 10 8.29091V15H6.67143V9.45c0-1.20682-.62143-1.88182-1.65-1.88182-.92857.0-1.69286.61364-1.69286 1.93637V15H0V0H3.32857V5.86364z" fill="#888"/></svg></a></li><li class=footer__social-item><a class=footer__social-link target=_blank rel="noopener noreferrer nofollow" href=https://vc.ru/leroymerlintech aria-label=" "><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8058 7.42086C13.9835 7.42086 14.8702 6.93019 15.524 6.07597L14.6502 5.4093c-.2158.28445-.4948.51489-.8149.67315-.32.15827-.672499999999999.24003-1.0295.23885-1.2783.0-2.2045-1.04134-2.2045-2.31912C10.6013 2.72441 11.5124 1.62442 12.8422 1.62442c.591099999999999.0 1.0089.13955 1.3733.36533V3.11329h1.0996V1.47508L15.1044 1.3093C14.5.833743 13.5769.581299 12.8053.581299c-1.8862.0-3.42043 1.534231-3.42043 3.420451.0 1.88444 1.53333 3.41911 3.42043 3.41911H12.8058zm2.2813 6.74664L15.048 12.5929V8.75019H12.7546v1.1h1.1352V12.4573C13.8898 13.5804 13.032 14.3755 12.1666 14.3755 11.3013 14.3755 10.8498 13.7755 10.8498 12.6529V8.74974H8.70753v1.1h.984V12.8435c0 1.5236.85427 2.5734 2.37777 2.5734.8756.0 1.5422-.485799999999999 1.94-1.2347H14.0271L14.184 15.2293h1.7622V14.1689H15.0884V14.1666L15.0871 14.1675zM9.13153.742635H7.22042L5.5582 5.5693H5.53242L3.87909.742635H1.84264V1.84307H2.98798L4.95909 7.34441H6.0062V7.34307L8.06176 1.84352H9.13064V.743083L9.13153.742635zM.0541992 15.2435H1.18664v-1.132H.0546437v1.132H.0541992zM4.42753 10.0257H4.41509L4.34398 8.75019H2.32264V9.75286H3.3982V14.168H2.32264v1.0609H7.3182v-1.04H4.53687V11.5244C4.66264 10.56 5.38576 9.73641 6.37242 9.73641H6.3902L6.3702 10.7222H7.46975V8.73196H6.60042C5.60487 8.72929 4.8662 9.26797 4.42709 10.0262L4.42753 10.0257z" fill="currentcolor"/></svg></a></li></ul></div></footer><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://unpkg.com/aos@next/dist/aos.js></script>
<script>AOS.init({once:!0})</script><script src=/js/main.min.828ff22d5ce7b2ddd81e4ba33231660d604f591dfe52c667e01e26ee5a574be8.js integrity="sha256-go/yLVznst3YHkujMjFmDWBPWR3+UsZn4B4m7lpXS+g=" crossorigin=anonymous></script></body></html>